-- v1.0.0 - Cheong - 2015/03/27 - Add SourceType to Views that contains dbo.SourceView
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO

ALTER VIEW [dbo].[V_WORDFILE]
AS
SELECT
	wf.WordFileID, wf.WordFileName, wf.[Description], wf.WordTemplateID, wf.AUDODATE, wt.WORDTEMPLATEName,
	sv.SOURCEVIEWNAME, sv.DATABASEID, sv.[DESC], sv.SOURCETYPE,
	sl.NAME VIEWLEVEL,
	wt.TemplateFileName, wt.VIEWID, wt.DataFileName
FROM dbo.WORDFILE wf
INNER JOIN dbo.WORDTEMPLATE wt ON wf.WordTemplateID = wt.WORDTEMPLATEID
INNER JOIN dbo.SOURCEVIEW sv ON wt.VIEWID = sv.ID
INNER JOIN dbo.SENSITIVITYLEVEL sl ON sv.VIEWLEVEL = sl.SLEVEL AND sv.DATABASEID = sl.DATABASEID

GO

ALTER VIEW [dbo].[V_WORDTEMPLATE]
AS
SELECT
	wt.WORDTEMPLATEID, wt.WORDTEMPLATEName, wt.[Description], wt.VIEWID,
	sv.SOURCEVIEWNAME, sv.DATABASEID, sv.SOURCETYPE, sl.NAME VIEWLEVEL,
	wt.TemplateFileName, wt.DataFileName
FROM         dbo.WORDTEMPLATE wt
INNER JOIN dbo.SOURCEVIEW sv ON wt.VIEWID = sv.ID
INNER JOIN dbo.SensitivityLevel sl ON sv.VIEWLEVEL = sl.SLEVEL AND sl.DATABASEID = sv.DATABASEID

GO
