--v1.8.4 Ben 2018.05.25 - Delete Duplicated records. Preserve the one's id exist in ReportColumn and the smallest id

DELETE SVC
FROM SOURCEVIEWCOLUMN svc 
	INNER JOIN
		(SELECT 
			RN = ROW_NUMBER() OVER(PARTITION BY SVC.SVID, SVC.COLUMNNAME ORDER BY RPID, SVC.ID DESC),
			SVC.*,RPID 
		FROM SOURCEVIEWCOLUMN SVC
			INNER JOIN 
				(SELECT COUNT(*) c, SVID, COLUMNNAME, MIN(ID) mnID, MAX(ID) mxID
				FROM SOURCEVIEWCOLUMN
				GROUP BY SVID, COLUMNNAME
				HAVING COUNT(*) > 1) SVC2 
			ON SVC.COLUMNNAME = SVC2.COLUMNNAME
				AND SVC.SVID = SVC2.SVID
			LEFT JOIN REPORTCOLUMN RC 
				ON RC.SOURCEVIEWCOLUMNID = SVC.ID) t
	ON svc.ID = t.ID
WHERE RN != 1